
# 目录 <!-- omit in toc -->

- [约定](#约定)
  - [规范](#规范)
  - [简称](#简称)
- [Version 0.4.0](#version-040)
  - [2024-10-16](#2024-10-16)
    - [Qt Edit 的问题](#qt-edit-的问题)
    - [解决](#解决)
    - [完善基本的 Edit](#完善基本的-edit)
  - [2024-10-14](#2024-10-14)
  - [2024-10-13 打算 \& 重构](#2024-10-13-打算--重构)
    - [计划](#计划)
    - [初步移植 la1\_gui 的界面](#初步移植-la1_gui-的界面)


<div style="page-break-after: always;"></div>


# 约定

## 规范

1. 不可出现的中文字符: `（`、`）`
2. 仅可以用在中文字符之间: `，`、`：`、`；`
3. 中文和字母之间应该使用空格分隔


## 简称

- **la1**: 编译器底层项目代号
- **la1_pkg**: la1 项目封装的库(接口)
- **la1_gui**: la1 项目开发出用于测试的简陋图形界面
- **la1_cmd**: la1 项目开发的命令行方式操作的程序


# Version 0.4.0




## 2024-10-16

### Qt Edit 的问题

Qt 的 `Edit` 包括: `QPlainTextEdit`、`QTextEdit`、`QTextBrowser`, 都无法设置行高，默认根据第一个字体高度+行间距判断，如果第一个字体是英文，第二个字体是中文，并且中文字体行间距更大。  

那么, Qt 会在输入中文时改变行高，造成不良影响：
- 一方面是：视觉上会给人很突兀的感觉。
- 另一方面：导致行号和行没法对齐 ( 我使用的是两个 `QPlainTextEdit` 组成行号和编辑框 )

### 解决

> ***一共花了我三天的时间***，各种方法都有尝试，包括 Qt 的 Edit 的各种设置，比如：样式表、Html、各种组件设置等。网上也找了非常多资料，都没有发现任何解决办法。

最后，我把主意打到了字体合并上，如果只存在一个字体，就没有这个问题了，但是只有一个字体并不能满足我对编辑器的感觉。

我先尝试了字体合并效果其实是不错的，之后尝试研究清除 Qt 不良影响的原因，发现正如我上面所说。

于是，我制作了一个仅在 `unicode: 0x1fdc` (未定义) 的位置含有一个空格的字体，设了 200 的行高。将其设置为第一个字体，以此来抵消 Qt 所带来的不良影响。

> Unicode 对照表: https://symbl.cc/cn/unicode-table/

### 完善基本的 Edit

之后我完善了一些简单的基础功能：
- tab 缩进: 
  - 可以设置为空格或者制表符
  - 可以设置缩进长度
  - TODO: 全文切换缩进
- back tab (shift+tab):
  - 可以减少所在行的缩进
  - 减少到光标或者第一个非缩进字符
- 对批量修改的优化:
  - 每行20个字符，复制十万行，大约耗时 **5 秒**



## 2024-10-14

1. 将 \<**la1_lib**> 更名为 \<**la1_pkg**>, 因为外部引用时使用 `find_package`



## 2024-10-13 打算 & 重构

### 计划

1. 打算将前后端彻底分离
   1. 编译器底层项目更名为使用代号 \<**la1**>
      1. l: lzl
      2. a: avs
      3. 1: 项目号
   2. \<**la1**> 将会推出三种封装
      1. 函数库: 提供 api 接口，方便图形界面开发时调用 (之后称作: \<**la1_lib**>)
      2. 由 \<**李宗霖**> 开发，测试时使用的简陋图形界面 (之后称作: \<**la1_gui**>)
      3. 以命令行集成命令的形式，类似于 **gcc** (之后称作: \<**la1_cmd**>)
2. 重构项目

### 初步移植 la1_gui 的界面

初步移植 la1_gui 的界面 (没有功能)

